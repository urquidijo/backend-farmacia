generator client {
  provider = "prisma-client-js"
  // output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserStatus {
  ACTIVE
  INACTIVE
}

model User {
id Int @id @default(autoincrement())
email String @unique
passwordHash String
firstName String
lastName String
status UserStatus @default(ACTIVE)
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt


roles UserRole[]
}


model Role {
id Int @id @default(autoincrement())
name String @unique // ej: ADMIN, VENDEDOR, CLIENTE
description String?
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt


permissions RolePermission[]
users UserRole[]
}


model Permission {
id Int @id @default(autoincrement())
key String @unique // ej: user.read, user.create, inv.read
description String?


roles RolePermission[]
}


model UserRole {
userId Int
roleId Int
user User @relation(fields: [userId], references: [id])
role Role @relation(fields: [roleId], references: [id])


@@id([userId, roleId])
}


model RolePermission {
roleId Int
permissionId Int
role Role @relation(fields: [roleId], references: [id])
permission Permission @relation(fields: [permissionId], references: [id])


@@id([roleId, permissionId])
}

model Marca {
id Int @id @default(autoincrement())
nombre String @unique
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt

productos Producto[]
}

model Categoria {
id Int @id @default(autoincrement())
nombre String @unique
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt

productos Producto[]
}

model Unidad {
id Int @id @default(autoincrement())
codigo String @unique
nombre String
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt

productos Producto[]
}

model Producto {
id Int @id @default(autoincrement())
nombre String
descripcion String?
stockMinimo Int @default(0)
activo Boolean @default(true)
imageKey String?
imageUrl String?
creadoEn DateTime @default(now())
actualizadoEn DateTime @updatedAt

marcaId Int
categoriaId Int
unidadId Int

marca Marca @relation(fields: [marcaId], references: [id])
categoria Categoria @relation(fields: [categoriaId], references: [id])
unidad Unidad @relation(fields: [unidadId], references: [id])
}

model Cliente {
id Int @id @default(autoincrement())
nombre String
apellido String?
nit String? @unique
telefono String?
email String?
direccion String?
activo Boolean @default(true)
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
}